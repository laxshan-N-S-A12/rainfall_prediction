<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rainfall Prediction</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prop-types/15.8.1/prop-types.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.2/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <div id="root"></div>
    <script type="text/babel">
        const { useState } = React;

        const InputField = ({ label, name, value, onChange, type = "number" }) => (
            <div className="mb-4">
                <label className="block text-gray-700 text-sm font-bold mb-2" htmlFor={name}>
                    {label}
                </label>
                <input
                    className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                    id={name}
                    type={type}
                    name={name}
                    value={value}
                    onChange={onChange}
                    required
                />
            </div>
        );

        const App = () => {
            const [formData, setFormData] = useState({
                pressure: '',
                maxtemp: '',
                temparature: '',
                mintemp: '',
                dewpoint: '',
                humidity: '',
                cloud: '',
                sunshine: '',
                winddirection: '',
                windspeed: ''
            });
            const [prediction, setPrediction] = useState(null);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState(null);

            const handleChange = (e) => {
                setFormData({
                    ...formData,
                    [e.target.name]: e.target.value
                });
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                setLoading(true);
                setError(null);

                try {
                    const response = await fetch('/predict', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(formData)
                    });

                    const data = await response.json();
                    
                    if (response.ok) {
                        setPrediction(data);
                    } else {
                        setError(data.error || 'Prediction failed');
                    }
                } catch (err) {
                    setError('Network error occurred');
                } finally {
                    setLoading(false);
                }
            };

            return (
                <div className="container mx-auto p-4">
                    <h1 className="text-3xl font-bold mb-6 text-center">Rainfall Prediction</h1>
                    
                    <div className="max-w-md mx-auto bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
                        <form onSubmit={handleSubmit}>
                            <InputField label="Pressure (hPa)" name="pressure" value={formData.pressure} onChange={handleChange} />
                            <InputField label="Max Temperature (째C)" name="maxtemp" value={formData.maxtemp} onChange={handleChange} />
                            <InputField label="Temperature (째C)" name="temparature" value={formData.temparature} onChange={handleChange} />
                            <InputField label="Min Temperature (째C)" name="mintemp" value={formData.mintemp} onChange={handleChange} />
                            <InputField label="Dewpoint (째C)" name="dewpoint" value={formData.dewpoint} onChange={handleChange} />
                            <InputField label="Humidity (%)" name="humidity" value={formData.humidity} onChange={handleChange} />
                            <InputField label="Cloud Cover (%)" name="cloud" value={formData.cloud} onChange={handleChange} />
                            <InputField label="Sunshine (hours)" name="sunshine" value={formData.sunshine} onChange={handleChange} />
                            <InputField label="Wind Direction (degrees)" name="winddirection" value={formData.winddirection} onChange={handleChange} />
                            <InputField label="Wind Speed (km/h)" name="windspeed" value={formData.windspeed} onChange={handleChange} />
                            
                            <div className="flex items-center justify-between">
                                <button
                                    className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
                                    type="submit"
                                    disabled={loading}
                                >
                                    {loading ? 'Predicting...' : 'Predict Rainfall'}
                                </button>
                            </div>
                        </form>
                    </div>

                    {prediction && (
                        <div className="max-w-md mx-auto bg-white shadow-md rounded px-8 pt-6 pb-8">
                            <h2 className="text-xl font-bold mb-4">Prediction Result</h2>
                            <p><strong>Will it rain?</strong> {prediction.prediction}</p>
                            <p><strong>Probability of rain:</strong> {(prediction.probability * 100).toFixed(2)}%</p>
                        </div>
                    )}

                    {error && (
                        <div className="max-w-md mx-auto bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
                            <p><strong>Error:</strong> {error}</p>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>